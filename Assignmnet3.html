<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Assignment 3</title>
  <link rel="stylesheet" href="style.css">
<style>
body {
  background-image: url('final/animated-sparkle-overlay-for-photoshop.gif');
  background-size: cover;
  background-repeat: no-repeat;
  background-position: center;
  color: white;
}

.code-box {
  width: 80%; /* Full width of the container */
  height: 200px; /* Fixed height with a vertical scrollbar */
  padding: 10px;
  margin-bottom: 20px;
  background-color: #f4f4f4; /* Light grey background */
  border: 1px solid #ccc; /* Light grey border */
  overflow-y: scroll; /* Scrollbar for overflowing content */
  font-family: 'Courier New', monospace; /* Monospaced font for code */
  white-space: pre; /* Maintains spacing and formatting */
  resize: none; /* Disables the resize handle */
}

  .project-container {
    background-color: #404040; /* Slightly darker grey background */

    padding: 20px; /* Adjust padding as needed */
    margin: auto; /* Center the container on the page */
    max-width: 1000px; /* Maximum width of the content area or 100% for full width */
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.5); /* Optional: Adds a subtle shadow around the container */
  }
 p {
    color: white; /* Ensure paragraphs are white */
  }
  h1, h2, h3, h4, h5, h6, p, a {
    color: white; /* Sets text color to white */
  }
  .slider-container img {
      width: 80%; /* Fill the width of the container */
      height: 400px; /* Fixed height for the portrait box */
      object-fit: contain; /* Ensure the whole image fits without cropping */
      display: none; /* Hide all images initially */
      background-color: black; /* Black background to fill empty space */
      margin: auto; /* Center the image in the container if it's smaller */
  }

  .slider-container img.active {
    display: block; /* Only show the active image */
  }

  .slider-sections-container {
    display: flex;
    justify-content: space-around; /* Space out the before and after sections evenly */
    flex-wrap: wrap; /* Enable wrapping for responsiveness */
  }

  .before-section, .after-section {
    flex: 1; /* Make each section take up equal space */
    min-width: 300px; /* Minimum width for each section */
  }

  @media (max-width: 768px) {
    .slider-sections-container {
      flex-direction: column;
    }
  }

  /* Ensure links are also white */
  a {
    color: white;
    text-decoration: none; /* Optional: Removes underline from links */
  }

  /* Optionally, add hover effect for links */
  a:hover {
    text-decoration: underline; /* Adds underline on hover */
  }
</style>




</head>
<body>
  <div class="link">
    <a href="index.html">Home</a>
    <a href="Assignment0.html">Assignment 0</a>
    <a href="Assignment1.html">Assignment 1</a>
    <a href="Assignment2.html">Assignment 2</a>
    <a href="Assignment3.html">Assignment 3</a>
  </div>

  <div class="project-container">
    <h1>Wheel-a-nator 2.0</h1>
    <p>For this project, I have iterated and improved my original project.</p>

    <!-- Image sliders for Before and After, side by side -->
    <div class="slider-sections-container">
     <!-- Before Section -->
<div class="before-section">
  <h2>Before</h2>
  <div class="slider-container">
    <img src="final/Main (1).jpg" alt="Concept Image 1" class="active before-image">
        <img src="final/Concept1 (1).jpg" alt="Concept Image 2" class="before-image">
    <img src="final/Concept2 (1).jpg" alt="Concept Image 2" class="before-image">
        <img src="final/Concept3.jpg" alt="Concept Image 2" class="before-image">
    <img src="final/Concept4.jpg" alt="Concept Image 2" class="before-image">

    <!-- More Before images -->
  </div>
  <button onclick="prevImageBefore()">Previous</button>
  <button onclick="nextImageBefore()">Next</button>
</div>

<!-- After Section -->
<div class="after-section">
  <h2>After</h2>
  <div class="slider-container">

    
    <!-- New After images -->
    <img src="final/IMG_8984.jpg" alt="After Image 3" class="after-image">
    <img src="final/IMG_8985.jpg" alt="After Image 4" class="after-image">
    <img src="final/IMG_8986.jpg" alt="After Image 5" class="after-image">
    <img src="final/IMG_8987.jpg" alt="After Image 6" class="after-image">
    <img src="final/IMG_8988.jpg" alt="After Image 7" class="after-image">
    <img src="final/IMG_8989.jpg" alt="After Image 8" class="after-image">
    <img src="final/IMG_8990.jpg" alt="After Image 9" class="after-image">
    <img src="final/IMG_8991.jpg" alt="After Image 10" class="after-image">
    <img src="final/IMG_8992.jpg" alt="After Image 11" class="after-image">
    <img src="final/IMG_8993.jpg" alt="After Image 12" class="after-image">
    <!-- Include any additional images here -->
  </div>
  <button onclick="prevImageAfter()">Previous</button>
  <button onclick="nextImageAfter()">Next</button>
</div>


    </div>
    
  <script>
  let currentBefore = 0;
  let currentAfter = 0;
  let imagesBefore = document.querySelectorAll('.before-image');
  let imagesAfter = document.querySelectorAll('.after-image');

  function showCurrentImage(images, current) {
    images.forEach(img => img.classList.remove('active'));
    images[current].classList.add('active');
  }

  function nextImageBefore() {
    currentBefore = (currentBefore + 1) % imagesBefore.length;
    showCurrentImage(imagesBefore, currentBefore);
  }

  function prevImageBefore() {
    currentBefore = (currentBefore - 1 + imagesBefore.length) % imagesBefore.length;
    showCurrentImage(imagesBefore, currentBefore);
  }

  function nextImageAfter() {
    currentAfter = (currentAfter + 1) % imagesAfter.length;
    showCurrentImage(imagesAfter, currentAfter);
  }

  function prevImageAfter() {
    currentAfter = (currentAfter - 1 + imagesAfter.length) % imagesAfter.length;
    showCurrentImage(imagesAfter, currentAfter);
  }

  // Initially display the first image for both sliders
  showCurrentImage(imagesBefore, currentBefore);
  showCurrentImage(imagesAfter, currentAfter);
</script>

    <p>"I connected the joystick and potentiometer to the Arduino, which collects all the data from these input devices. Then, I connected the Arduino 
      to the computer. The Python script on the computer processes the data collected by the Arduino, mapping the positions of the potentiometer and 
      joystick to specific tones and octaves. Additionally, the foot pedal is connected to the laptop, enabling the user to play the tones at will. 
      What sets this iteration apart from the previous one is the inclusion of the joystick and the foot pedal. The joystick offers superior control 
      in selecting octaves compared to the potentiometer, which I used for octave control in my previous iteration. Moreover, the joystick allows access 
      to all 8 octaves, unlike the previous setup, which was limited to 4.</p>
      
      <p>The foot pedal gives users the ability to play a tone whenever they wish. All they need to do is move the wheel to the desired tone position, 
      select the octave with the joystick, and then press on the pedal. Theoretically, this setup could be used to play music just like any musical 
      instrument. Additionally, since the tones are produced electronically, they can be changed. Ultimately, I believe this instrument is easier 
      to play since it doesnâ€™t require the hand dexterity that most instruments do, and it can be customized to the user's liking."</p>

<div class="video-demo">
  <video width="560" height="315" controls>
    <source src="final/finaL.mp4" type="video/mp4">
    Your browser does not support the video tag.
  </video>
  <br>
</div>

    
    <div class="code-container">
  <h2>Arduino Code:</h2>
  <textarea readonly class="code-box">
const int potPin1 = A0; // Potentiometer pin
const int joyXPin = A1; // Joystick X-axis pin
const int joyYPin = A2; // Joystick Y-axis pin

// Variable to store the last section index reported for the potentiometer
int lastSectionIndex1 = -1; // Initialize with -1 so it's different from the first reading
// Variable to store the last reported direction for the joystick
String lastDirection = "Neutral";

void setup() {
  Serial.begin(9600);
}

void loop() {
  // Potentiometer reading and section determination
  int potValue1 = analogRead(potPin1);
  int sectionIndex1 = potValue1 / 128; // Divide by 128 to get 8 sections
  if (sectionIndex1 > 7) {
    sectionIndex1 = 7; // Ensure the section index doesn't exceed 7
  }

  // Update and print only if there's a change in the potentiometer section
  if (sectionIndex1 != lastSectionIndex1) {
    lastSectionIndex1 = sectionIndex1;
    Serial.print("Pot1 section: ");
    Serial.println(sectionIndex1);
  }

  // Joystick direction determination
  int joyXValue = analogRead(joyXPin);
  int joyYValue = analogRead(joyYPin);
  String direction = getJoystickDirection(joyXValue, joyYValue);

  if (direction != lastDirection) {
    lastDirection = direction;
    Serial.print("Joystick Direction: ");
    Serial.println(direction);
  }

  delay(100); // Short delay to limit data rate
}

String getJoystickDirection(int x, int y) {
  // Define the dead zone in the center of the joystick
  int deadZone = 50;
  int centerX = 512; // Center value for X when the joystick is centered
  int centerY = 512; // Center value for Y when the joystick is centered

  // Calculate the difference from the center
  int diffX = x - centerX;
  int diffY = y - centerY;

  // Check if within the dead zone (neutral)
  if (abs(diffX) < deadZone && abs(diffY) < deadZone) {
    return "Neutral";
  }

  // Determine direction based on the angle
  float angle = atan2(diffY, diffX) * 180 / PI;
  if (angle < 0) angle += 360;

  if (angle > 337.5 || angle <= 22.5) return "E";
  if (angle > 22.5 && angle <= 67.5) return "NE";
  if (angle > 67.5 && angle <= 112.5) return "N";
  if (angle > 112.5 && angle <= 157.5) return "NW";
  if (angle > 157.5 && angle <= 202.5) return "W";
  if (angle > 202.5 && angle <= 247.5) return "SW";
  if (angle > 247.5 && angle <= 292.5) return "S";
  if (angle > 292.5 && angle <= 337.5) return "SE";

  // Default to Neutral if no other direction is matched
  return "Neutral";
}

  </textarea>

  <h2>Python Code:</h2>
  <textarea readonly class="code-box">
import numpy as np
import pygame
import serial
import threading

# Initialize Pygame and mixer
pygame.mixer.init(frequency=44100, size=-16, channels=1)
pygame.init()

# Serial port setup
ser = serial.Serial('/dev/tty.usbmodem14201', 9600, timeout=1)
ser.flush()

# Base note frequencies for the octave
base_note_frequencies = [261.63, 293.66, 329.63, 392.00, 440.00, 493.88]
# Current note frequencies, starting with the base octave
current_note_frequencies = base_note_frequencies.copy()

# Global variables
current_section_index = None
current_octave_shift = 0  # Tracks the current octave shift based on joystick direction

def adjust_octave(direction):
    global current_note_frequencies, current_octave_shift
    octave_shift_map = {"N": 1, "S": -1, "Neutral": 0}  # Map directions to octave shifts
    shift = octave_shift_map.get(direction, 0)
    if shift != current_octave_shift:
        current_octave_shift = shift
        if shift == 1:
            # Shift up one octave
            current_note_frequencies = [freq * 2 for freq in base_note_frequencies]
        elif shift == -1:
            # Shift down one octave
            current_note_frequencies = [freq / 2 for freq in base_note_frequencies]
        else:
            # Reset to base octave
            current_note_frequencies = base_note_frequencies.copy()

def play_tone(frequency, duration=1000):
    t = np.linspace(0, duration / 1000, int(44100 * (duration / 1000)), False)
    tone = np.sin(frequency * t * 2 * np.pi)
    tone = (tone * 32767).astype(np.int16)
    sound = pygame.sndarray.make_sound(tone)
    sound.play()
    pygame.time.delay(duration)

def read_serial():
    global current_section_index
    while True:
        if ser.in_waiting > 0:
            line = ser.readline().decode('utf-8').rstrip()
            if line.startswith("Pot1 section: "):
                current_section_index = int(line.split(": ")[1])
            elif line.startswith("Joystick Direction: "):
                direction = line.split(": ")[1]
                adjust_octave(direction)

def wait_for_space_and_play():
    global current_section_index
    running = True
    while running:
        for event in pygame.event.get():
            if event.type == pygame.KEYDOWN:
                if event.key == pygame.K_SPACE and current_section_index is not None:
                    frequency = current_note_frequencies[current_section_index % len(current_note_frequencies)]
                    print(f"Playing tone for section {current_section_index} at frequency {frequency} Hz.")
                    play_tone(frequency)
            elif event.type == pygame.QUIT:
                running = False
                pygame.quit()
                return

threading.Thread(target=read_serial, daemon=True).start()
wait_for_space_and_play()

  </textarea>
</div>



    

    <div class="circuit-diagram">
     

           <img src="final/circuit2.jpg" alt="Circuit Diagram">
<p>"This circuit diagram represents the core component of our project. It resides within the Wheel-a-nator, where it collects all the data from the input devices."</p>

 <img src="final/circuit1.jpg" alt="Circuit Diagram">
          <p>This is the section where the primary processing occurs. The Python script on the computer processes the data collected by the Arduino, mapping 
            the positions of the potentiometer and joystick to specific tones and octaves.Additionally, the foot pedal is connected to the laptop, enabling 
            the user to play the tones at will.</p>
    </div>

    <div class="references">
      <h2>List of References</h2>
      <ul>
        <li>Reference 1: <a href="https://docs.arduino.cc/learn/electronics/potentiometer-basics/" target="_blank">potentiometer basics </a></li>
                <li>Reference 1: <a href="https://arduinogetstarted.com/tutorials/arduino-joystick" target="_blank">Joystick basics </a></li>



        <!-- Add more references as needed -->
      </ul>
    </div>
  </div>
</body>
</html>
